# 无人驾驶汽车项目（基于CARLA 0.9.10+ROS）
## 项目简介
本项目是基于**CARLA 0.9.10**开源仿真平台、Python 3.8+及ROS机器人操作系统开发的无人驾驶仿真系统，聚焦自动驾驶“感知-规划-控制”核心流程的落地实现。通过CARLA 0.9.10获取高保真的虚拟交通场景与传感器数据，结合计算机视觉、经典路径规划算法和PID控制技术，实现车辆自主导航、避障与路径跟踪，并利用ROS完成模块间分布式通信，同时通过FPV模块实现第一视角实时可视化，是自动驾驶入门实践的轻量化项目。

## 核心功能
1. **CARLA 0.9.10仿真交互**：支持加载城市场景、创建车辆与多传感器（摄像头、激光雷达、GPS/IMU），实时获取传感器数据并下发车辆控制指令，完美适配CARLA 0.9.10的API特性与车辆动力学模型。
2. **环境感知**：采用YOLOv8+OpenCV实现车辆、行人、障碍物的实时目标检测，结合激光雷达点云聚类完成障碍物的精准定位与距离测算。
3. **路径规划**：基于A*算法生成全局最优路径，RRT*算法实现动态避障的局部路径规划，输出适配车辆行驶的平滑参考轨迹。
4. **车辆控制**：通过PID控制器实现转向、速度与制动的精准控制，高效跟踪规划路径，保证车辆行驶的稳定性。
5. **模块化通信与可视化**：ROS模块实现感知、规划、控制模块的话题订阅与发布，支持分布式调试；FPV模块实时渲染车辆第一视角画面及检测结果。

## 技术栈
| 类别         | 具体技术/工具                          |
|--------------|---------------------------------------|
| 开发环境     | PyCharm Community Edition 2024+、Windows/Linux |
| 核心语言     | Python 3.8+                           |
| 仿真平台     | CARLA 0.9.10、CARLA Python API        |
| 计算机视觉   | OpenCV、NumPy、YOLOv8（Ultralytics）  |
| 路径规划     | A*、RRT*算法                          |
| 控制理论     | PID控制器                              |
| 通信框架     | ROS（Noetic/Melodic）、rospy          |
| 可视化工具   | PyGame、Matplotlib                    |

## 快速开始
### 1. 环境准备
1. 安装Python 3.8+，创建并激活虚拟环境；
2. 安装项目依赖：`pip install -r requirements.txt`（核心依赖：`carla==0.9.10`、opencv-python、ultralytics、numpy、pygame、rospy）；
3. 配置ROS环境（可选）：安装对应版本ROS并初始化工作空间，将项目中`ros`文件夹链接到ROS工作空间`src`目录；
4. 启动CARLA 0.9.10模拟器：运行`CarlaUE4.exe`（Windows）或`CarlaUE4.sh`（Linux）。

### 2. 项目运行
#### （1）无ROS模式
直接运行主程序，自动连接CARLA并启动全流程功能：
```bash
python main.py
```

#### （2）ROS模式
1. 启动ROS核心：`roscore`；
2. 依次启动CARLA-ROS桥接节点、感知/规划/控制节点及FPV可视化节点（具体命令见项目内注释）；
3. 各节点通过ROS话题实现数据交互，完成车辆自主导航。

## 项目结构
```
autonomous_driving_car/
├── FPV/             # 第一视角可视化模块
├── MCP/             # 主控制模块（集成感知、规划、控制核心逻辑）
├── ros/             # ROS通信模块
├── main.py          # 项目入口
└── README.md        # 项目说明文档
```

## 常见问题
1. **CARLA 0.9.10连接失败**：确保模拟器已启动，且Python安装的`carla`版本为0.9.10（可通过`pip show carla`查看版本）；
2. **ROS节点无数据交互**：检查`roscore`是否启动、话题名称是否一致、ROS环境变量是否正确`source`；
3. **YOLO检测速度慢**：使用YOLOv8n轻量级模型，或启用GPU加速（需安装CUDA）；
4. **车辆控制不稳定**：调整PID控制器的P/I/D参数，或对规划路径进行平滑处理；
5. **CARLA 0.9.10传感器数据异常**：确认传感器挂载位置与参数设置符合CARLA 0.9.10的Actor生成规则。